name: Discord - Notify on push

on:
  push:
    branches:
      - '**'          # k√∂r p√• ALLA branches (enkelt att testa)
  workflow_dispatch:  # s√• du kan k√∂ra manuellt fr√•n Actions

jobs:
  notify-discord:
    runs-on: ubuntu-latest

    steps:
      - name: Kontrollera och skicka till Discord
        env:
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          if [ -z "$DISCORD_WEBHOOK_URL" ]; then
            echo "‚ùå Secret DISCORD_WEBHOOK saknas eller √§r tomt."
            exit 1
          fi

          echo "‚úÖ Secret DISCORD_WEBHOOK finns."

          MESSAGE="‚úÖ Alan √§r klar! üöÄ Ny push till ${GITHUB_REPOSITORY} p√• branch ${GITHUB_REF_NAME} av ${GITHUB_ACTOR}"

          echo "Skickar detta meddelande:"
          echo "$MESSAGE"

          curl -v -H "Content-Type: application/json" \
               -d "{\"content\": \"${MESSAGE}\"}" \
               "$DISCORD_WEBHOOK_URL"
